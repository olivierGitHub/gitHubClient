package com.prismic2.service;


import com.prismic2.dto.RepositoryDto;
import com.prismic2.util.helper.JsonHelper;
import com.prismic2.util.helper.UrlHelper;
import com.prismic2.util.mapper.RepositoriesMapper;
import org.junit.Assert;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.Mockito;
import org.mockito.Spy;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringRunner;

import java.net.HttpURLConnection;
import java.util.List;

@RunWith(SpringRunner.class)
@SpringBootTest
public class RepositoriesServiceTest {

    private final String REPOSITORY_JSON_STRING = "{\"id\":33642092,\"name\":\"AngularMaterialProject\",\"full_name\":\"olivierGitHub/AngularMaterialProject\",\"owner\":{\"login\":\"olivierGitHub\",\"id\":6985323,\"avatar_url\":\"https://avatars0.githubusercontent.com/u/6985323?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/olivierGitHub\",\"html_url\":\"https://github.com/olivierGitHub\",\"followers_url\":\"https://api.github.com/users/olivierGitHub/followers\",\"following_url\":\"https://api.github.com/users/olivierGitHub/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/olivierGitHub/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/olivierGitHub/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/olivierGitHub/subscriptions\",\"organizations_url\":\"https://api.github.com/users/olivierGitHub/orgs\",\"repos_url\":\"https://api.github.com/users/olivierGitHub/repos\",\"events_url\":\"https://api.github.com/users/olivierGitHub/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/olivierGitHub/received_events\",\"type\":\"User\",\"site_admin\":false},\"private\":false,\"html_url\":\"https://github.com/olivierGitHub/AngularMaterialProject\",\"description\":\"just a quick test of Angular Material\",\"fork\":false,\"url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject\",\"forks_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/forks\",\"keys_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/teams\",\"hooks_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/hooks\",\"issue_events_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/events\",\"assignees_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/tags\",\"blobs_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/languages\",\"stargazers_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/stargazers\",\"contributors_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/contributors\",\"subscribers_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/subscribers\",\"subscription_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/subscription\",\"commits_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/merges\",\"archive_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/downloads\",\"issues_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/releases{/id}\",\"deployments_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/deployments\",\"created_at\":\"2015-04-09T01:38:46Z\",\"updated_at\":\"2015-04-09T01:40:40Z\",\"pushed_at\":\"2015-04-09T01:40:39Z\",\"git_url\":\"git://github.com/olivierGitHub/AngularMaterialProject.git\",\"ssh_url\":\"git@github.com:olivierGitHub/AngularMaterialProject.git\",\"clone_url\":\"https://github.com/olivierGitHub/AngularMaterialProject.git\",\"svn_url\":\"https://github.com/olivierGitHub/AngularMaterialProject\",\"homepage\":null,\"size\":1104,\"stargazers_count\":0,\"watchers_count\":0,\"language\":\"HTML\",\"has_issues\":true,\"has_projects\":true,\"has_downloads\":true,\"has_wiki\":true,\"has_pages\":false,\"forks_count\":0,\"mirror_url\":null,\"open_issues_count\":0,\"forks\":0,\"open_issues\":0,\"watchers\":0,\"default_branch\":\"master\"}";
    private final String JSON_RESPONSE = "[{\"id\":33642092,\"name\":\"AngularMaterialProject\",\"full_name\":\"olivierGitHub/AngularMaterialProject\",\"owner\":{\"login\":\"olivierGitHub\",\"id\":6985323,\"avatar_url\":\"https://avatars0.githubusercontent.com/u/6985323?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/olivierGitHub\",\"html_url\":\"https://github.com/olivierGitHub\",\"followers_url\":\"https://api.github.com/users/olivierGitHub/followers\",\"following_url\":\"https://api.github.com/users/olivierGitHub/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/olivierGitHub/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/olivierGitHub/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/olivierGitHub/subscriptions\",\"organizations_url\":\"https://api.github.com/users/olivierGitHub/orgs\",\"repos_url\":\"https://api.github.com/users/olivierGitHub/repos\",\"events_url\":\"https://api.github.com/users/olivierGitHub/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/olivierGitHub/received_events\",\"type\":\"User\",\"site_admin\":false},\"private\":false,\"html_url\":\"https://github.com/olivierGitHub/AngularMaterialProject\",\"description\":\"just a quick test of Angular Material\",\"fork\":false,\"url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject\",\"forks_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/forks\",\"keys_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/teams\",\"hooks_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/hooks\",\"issue_events_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/events\",\"assignees_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/tags\",\"blobs_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/languages\",\"stargazers_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/stargazers\",\"contributors_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/contributors\",\"subscribers_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/subscribers\",\"subscription_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/subscription\",\"commits_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/merges\",\"archive_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/downloads\",\"issues_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/releases{/id}\",\"deployments_url\":\"https://api.github.com/repos/olivierGitHub/AngularMaterialProject/deployments\",\"created_at\":\"2015-04-09T01:38:46Z\",\"updated_at\":\"2015-04-09T01:40:40Z\",\"pushed_at\":\"2015-04-09T01:40:39Z\",\"git_url\":\"git://github.com/olivierGitHub/AngularMaterialProject.git\",\"ssh_url\":\"git@github.com:olivierGitHub/AngularMaterialProject.git\",\"clone_url\":\"https://github.com/olivierGitHub/AngularMaterialProject.git\",\"svn_url\":\"https://github.com/olivierGitHub/AngularMaterialProject\",\"homepage\":null,\"size\":1104,\"stargazers_count\":0,\"watchers_count\":0,\"language\":\"HTML\",\"has_issues\":true,\"has_projects\":true,\"has_downloads\":true,\"has_wiki\":true,\"has_pages\":false,\"forks_count\":0,\"mirror_url\":null,\"open_issues_count\":0,\"forks\":0,\"open_issues\":0,\"watchers\":0,\"default_branch\":\"master\"},{\"id\":48450153,\"name\":\"AutocompleteReact\",\"full_name\":\"olivierGitHub/AutocompleteReact\",\"owner\":{\"login\":\"olivierGitHub\",\"id\":6985323,\"avatar_url\":\"https://avatars0.githubusercontent.com/u/6985323?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/olivierGitHub\",\"html_url\":\"https://github.com/olivierGitHub\",\"followers_url\":\"https://api.github.com/users/olivierGitHub/followers\",\"following_url\":\"https://api.github.com/users/olivierGitHub/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/olivierGitHub/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/olivierGitHub/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/olivierGitHub/subscriptions\",\"organizations_url\":\"https://api.github.com/users/olivierGitHub/orgs\",\"repos_url\":\"https://api.github.com/users/olivierGitHub/repos\",\"events_url\":\"https://api.github.com/users/olivierGitHub/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/olivierGitHub/received_events\",\"type\":\"User\",\"site_admin\":false},\"private\":false,\"html_url\":\"https://github.com/olivierGitHub/AutocompleteReact\",\"description\":\"Autocomplete using ReactJS\",\"fork\":false,\"url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact\",\"forks_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/forks\",\"keys_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/teams\",\"hooks_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/hooks\",\"issue_events_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/events\",\"assignees_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/tags\",\"blobs_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/languages\",\"stargazers_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/stargazers\",\"contributors_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/contributors\",\"subscribers_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/subscribers\",\"subscription_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/subscription\",\"commits_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/merges\",\"archive_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/downloads\",\"issues_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/releases{/id}\",\"deployments_url\":\"https://api.github.com/repos/olivierGitHub/AutocompleteReact/deployments\",\"created_at\":\"2015-12-22T19:33:12Z\",\"updated_at\":\"2015-12-22T19:34:11Z\",\"pushed_at\":\"2015-12-22T22:56:47Z\",\"git_url\":\"git://github.com/olivierGitHub/AutocompleteReact.git\",\"ssh_url\":\"git@github.com:olivierGitHub/AutocompleteReact.git\",\"clone_url\":\"https://github.com/olivierGitHub/AutocompleteReact.git\",\"svn_url\":\"https://github.com/olivierGitHub/AutocompleteReact\",\"homepage\":null,\"size\":1695,\"stargazers_count\":0,\"watchers_count\":0,\"language\":\"JavaScript\",\"has_issues\":true,\"has_projects\":true,\"has_downloads\":true,\"has_wiki\":true,\"has_pages\":false,\"forks_count\":0,\"mirror_url\":null,\"open_issues_count\":0,\"forks\":0,\"open_issues\":0,\"watchers\":0,\"default_branch\":\"master\"},{\"id\":29760168,\"name\":\"BigDataProject\",\"full_name\":\"olivierGitHub/BigDataProject\",\"owner\":{\"login\":\"olivierGitHub\",\"id\":6985323,\"avatar_url\":\"https://avatars0.githubusercontent.com/u/6985323?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/olivierGitHub\",\"html_url\":\"https://github.com/olivierGitHub\",\"followers_url\":\"https://api.github.com/users/olivierGitHub/followers\",\"following_url\":\"https://api.github.com/users/olivierGitHub/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/olivierGitHub/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/olivierGitHub/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/olivierGitHub/subscriptions\",\"organizations_url\":\"https://api.github.com/users/olivierGitHub/orgs\",\"repos_url\":\"https://api.github.com/users/olivierGitHub/repos\",\"events_url\":\"https://api.github.com/users/olivierGitHub/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/olivierGitHub/received_events\",\"type\":\"User\",\"site_admin\":false},\"private\":false,\"html_url\":\"https://github.com/olivierGitHub/BigDataProject\",\"description\":\"Projet Olifirenkoff\",\"fork\":false,\"url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject\",\"forks_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/forks\",\"keys_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/teams\",\"hooks_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/hooks\",\"issue_events_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/events\",\"assignees_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/tags\",\"blobs_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/languages\",\"stargazers_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/stargazers\",\"contributors_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/contributors\",\"subscribers_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/subscribers\",\"subscription_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/subscription\",\"commits_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/merges\",\"archive_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/downloads\",\"issues_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/releases{/id}\",\"deployments_url\":\"https://api.github.com/repos/olivierGitHub/BigDataProject/deployments\",\"created_at\":\"2015-01-24T00:40:36Z\",\"updated_at\":\"2015-08-23T13:10:43Z\",\"pushed_at\":\"2015-02-27T19:00:40Z\",\"git_url\":\"git://github.com/olivierGitHub/BigDataProject.git\",\"ssh_url\":\"git@github.com:olivierGitHub/BigDataProject.git\",\"clone_url\":\"https://github.com/olivierGitHub/BigDataProject.git\",\"svn_url\":\"https://github.com/olivierGitHub/BigDataProject\",\"homepage\":null,\"size\":708,\"stargazers_count\":1,\"watchers_count\":1,\"language\":\"XML\",\"has_issues\":true,\"has_projects\":true,\"has_downloads\":true,\"has_wiki\":true,\"has_pages\":false,\"forks_count\":1,\"mirror_url\":null,\"open_issues_count\":0,\"forks\":1,\"open_issues\":0,\"watchers\":1,\"default_branch\":\"dev\"}]";

    @Mock
    private JsonHelper jsonHelper;

    @Mock
    private UrlHelper urlHelper;

    @Spy
    private RepositoriesMapper repositoriesMapper;

    @InjectMocks
    private RepositoryService repositoryService;

    @Test
    public void getAllRepositories_should_return_a_list_of_RepositoryDto() throws Exception {
        // GIVEN
        HttpURLConnection httpURLConnection = null;

        // WHEN
        Mockito.when(urlHelper.getConnection(Mockito.anyString())).thenReturn(httpURLConnection);
        Mockito.when(urlHelper.getResponse(Mockito.any())).thenReturn(JSON_RESPONSE);
        Mockito.when(jsonHelper.toJsonObjectList(JSON_RESPONSE)).thenCallRealMethod();

        // THEN
        List<RepositoryDto> allRepositories = repositoryService.getAllRepositories("user");

        // ASSERT
        Assert.assertNotNull(allRepositories);
        Assert.assertEquals(allRepositories.size(), 3);
        Assert.assertEquals(allRepositories.get(0).getName(), "AngularMaterialProject");
        Assert.assertEquals(allRepositories.get(1).getName(), "AutocompleteReact");
        Assert.assertEquals(allRepositories.get(2).getName(), "BigDataProject");
    }

    @Test
    public void getAllRepositories_should_return_empty_list() throws Exception {
        // GIVEN
        HttpURLConnection httpURLConnection = null;

        // WHEN
        Mockito.when(urlHelper.getConnection(Mockito.anyString())).thenReturn(httpURLConnection);
        Mockito.when(urlHelper.getResponse(Mockito.any())).thenReturn(JSON_RESPONSE);
        Mockito.when(jsonHelper.toJsonObjectList(JSON_RESPONSE)).thenCallRealMethod();

        // THEN
        List<RepositoryDto> allRepositories = repositoryService.getAllRepositories(" ");

        // ASSERT
        Assert.assertNotNull(allRepositories);
        Assert.assertEquals(allRepositories.size(), 0);
    }

    @Test
    public void getRepository_should_return_a_RepositoryDto() throws Exception {
        // GIVEN
        HttpURLConnection httpURLConnection = null;

        // WHEN
        Mockito.when(urlHelper.getConnection(Mockito.anyString())).thenReturn(httpURLConnection);
        Mockito.when(urlHelper.getResponse(Mockito.any())).thenReturn(REPOSITORY_JSON_STRING);

        // THEN
        RepositoryDto repositoryDto = repositoryService.getRepository("olivier", "react");

        // ASSERT
        Assert.assertNotNull(repositoryDto);
        Assert.assertEquals(repositoryDto.getName(), "AngularMaterialProject");
    }

    @Test
    public void getRepository_should_return_null() throws Exception {
        // GIVEN
        HttpURLConnection httpURLConnection = null;

        // WHEN
        Mockito.when(urlHelper.getConnection(Mockito.anyString())).thenReturn(httpURLConnection);
        Mockito.when(urlHelper.getResponse(Mockito.any())).thenReturn(REPOSITORY_JSON_STRING);

        // THEN
        RepositoryDto repositoryDto = repositoryService.getRepository(" ", "react");

        // ASSERT
        Assert.assertNull(repositoryDto);
    }

}
