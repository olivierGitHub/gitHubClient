package com.prismic2.helper;


import com.prismic2.util.helper.JsonHelper;
import org.json.JSONException;
import org.json.JSONObject;
import org.junit.Assert;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringRunner;

import java.util.List;

@RunWith(SpringRunner.class)
@SpringBootTest
public class JsonHelperTest {

    @Autowired
    private JsonHelper jsonHelper;

    private final String JSON_RESPONSE = "[{\"sha\":\"1e83bea2d19d5e937f6e9549be03c341aae627c1\",\"commit\":{\"author\":{\"name\":\"olivier\",\"email\":\"olivier_coulibaly@yahoo.fr\",\"date\":\"2017-06-04T19:42:27Z\"},\"committer\":{\"name\":\"olivier\",\"email\":\"olivier_coulibaly@yahoo.fr\",\"date\":\"2017-06-04T19:42:27Z\"},\"message\":\"readme modified\",\"tree\":{\"sha\":\"51805b6044d4c89b147cef96af26a97c535c7a50\",\"url\":\"https://api.github.com/repos/olivierGitHub/react-hello-world/git/trees/51805b6044d4c89b147cef96af26a97c535c7a50\"},\"url\":\"https://api.github.com/repos/olivierGitHub/react-hello-world/git/commits/1e83bea2d19d5e937f6e9549be03c341aae627c1\",\"comment_count\":0,\"verification\":{\"verified\":false,\"reason\":\"unsigned\",\"signature\":null,\"payload\":null}},\"url\":\"https://api.github.com/repos/olivierGitHub/react-hello-world/commits/1e83bea2d19d5e937f6e9549be03c341aae627c1\",\"html_url\":\"https://github.com/olivierGitHub/react-hello-world/commit/1e83bea2d19d5e937f6e9549be03c341aae627c1\",\"comments_url\":\"https://api.github.com/repos/olivierGitHub/react-hello-world/commits/1e83bea2d19d5e937f6e9549be03c341aae627c1/comments\",\"author\":{\"login\":\"olivierGitHub\",\"id\":6985323,\"avatar_url\":\"https://avatars0.githubusercontent.com/u/6985323?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/olivierGitHub\",\"html_url\":\"https://github.com/olivierGitHub\",\"followers_url\":\"https://api.github.com/users/olivierGitHub/followers\",\"following_url\":\"https://api.github.com/users/olivierGitHub/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/olivierGitHub/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/olivierGitHub/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/olivierGitHub/subscriptions\",\"organizations_url\":\"https://api.github.com/users/olivierGitHub/orgs\",\"repos_url\":\"https://api.github.com/users/olivierGitHub/repos\",\"events_url\":\"https://api.github.com/users/olivierGitHub/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/olivierGitHub/received_events\",\"type\":\"User\",\"site_admin\":false},\"committer\":{\"login\":\"olivierGitHub\",\"id\":6985323,\"avatar_url\":\"https://avatars0.githubusercontent.com/u/6985323?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/olivierGitHub\",\"html_url\":\"https://github.com/olivierGitHub\",\"followers_url\":\"https://api.github.com/users/olivierGitHub/followers\",\"following_url\":\"https://api.github.com/users/olivierGitHub/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/olivierGitHub/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/olivierGitHub/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/olivierGitHub/subscriptions\",\"organizations_url\":\"https://api.github.com/users/olivierGitHub/orgs\",\"repos_url\":\"https://api.github.com/users/olivierGitHub/repos\",\"events_url\":\"https://api.github.com/users/olivierGitHub/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/olivierGitHub/received_events\",\"type\":\"User\",\"site_admin\":false},\"parents\":[{\"sha\":\"9d0c454bc2163d2d4e12419e444af3632ec141a1\",\"url\":\"https://api.github.com/repos/olivierGitHub/react-hello-world/commits/9d0c454bc2163d2d4e12419e444af3632ec141a1\",\"html_url\":\"https://github.com/olivierGitHub/react-hello-world/commit/9d0c454bc2163d2d4e12419e444af3632ec141a1\"}]},{\"sha\":\"9d0c454bc2163d2d4e12419e444af3632ec141a1\",\"commit\":{\"author\":{\"name\":\"olivierGitHub\",\"email\":\"jacques-olivier.coulibaly@soat.fr\",\"date\":\"2017-06-04T19:38:34Z\"},\"committer\":{\"name\":\"GitHub\",\"email\":\"noreply@github.com\",\"date\":\"2017-06-04T19:38:34Z\"},\"message\":\"Create README.md\",\"tree\":{\"sha\":\"21ab54a4786c52d9c63433a2619d32662336986c\",\"url\":\"https://api.github.com/repos/olivierGitHub/react-hello-world/git/trees/21ab54a4786c52d9c63433a2619d32662336986c\"},\"url\":\"https://api.github.com/repos/olivierGitHub/react-hello-world/git/commits/9d0c454bc2163d2d4e12419e444af3632ec141a1\",\"comment_count\":0,\"verification\":{\"verified\":false,\"reason\":\"unsigned\",\"signature\":null,\"payload\":null}},\"url\":\"https://api.github.com/repos/olivierGitHub/react-hello-world/commits/9d0c454bc2163d2d4e12419e444af3632ec141a1\",\"html_url\":\"https://github.com/olivierGitHub/react-hello-world/commit/9d0c454bc2163d2d4e12419e444af3632ec141a1\",\"comments_url\":\"https://api.github.com/repos/olivierGitHub/react-hello-world/commits/9d0c454bc2163d2d4e12419e444af3632ec141a1/comments\",\"author\":{\"login\":\"olivierGitHub\",\"id\":6985323,\"avatar_url\":\"https://avatars0.githubusercontent.com/u/6985323?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/olivierGitHub\",\"html_url\":\"https://github.com/olivierGitHub\",\"followers_url\":\"https://api.github.com/users/olivierGitHub/followers\",\"following_url\":\"https://api.github.com/users/olivierGitHub/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/olivierGitHub/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/olivierGitHub/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/olivierGitHub/subscriptions\",\"organizations_url\":\"https://api.github.com/users/olivierGitHub/orgs\",\"repos_url\":\"https://api.github.com/users/olivierGitHub/repos\",\"events_url\":\"https://api.github.com/users/olivierGitHub/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/olivierGitHub/received_events\",\"type\":\"User\",\"site_admin\":false},\"committer\":{\"login\":\"web-flow\",\"id\":19864447,\"avatar_url\":\"https://avatars3.githubusercontent.com/u/19864447?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/web-flow\",\"html_url\":\"https://github.com/web-flow\",\"followers_url\":\"https://api.github.com/users/web-flow/followers\",\"following_url\":\"https://api.github.com/users/web-flow/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/web-flow/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/web-flow/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/web-flow/subscriptions\",\"organizations_url\":\"https://api.github.com/users/web-flow/orgs\",\"repos_url\":\"https://api.github.com/users/web-flow/repos\",\"events_url\":\"https://api.github.com/users/web-flow/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/web-flow/received_events\",\"type\":\"User\",\"site_admin\":false},\"parents\":[{\"sha\":\"22428e8262e3324ea602602ef1d48da888a6fda2\",\"url\":\"https://api.github.com/repos/olivierGitHub/react-hello-world/commits/22428e8262e3324ea602602ef1d48da888a6fda2\",\"html_url\":\"https://github.com/olivierGitHub/react-hello-world/commit/22428e8262e3324ea602602ef1d48da888a6fda2\"}]},{\"sha\":\"22428e8262e3324ea602602ef1d48da888a6fda2\",\"commit\":{\"author\":{\"name\":\"olivier\",\"email\":\"olivier_coulibaly@yahoo.fr\",\"date\":\"2017-06-04T19:27:36Z\"},\"committer\":{\"name\":\"olivier\",\"email\":\"olivier_coulibaly@yahoo.fr\",\"date\":\"2017-06-04T19:27:36Z\"},\"message\":\"first commit\",\"tree\":{\"sha\":\"7e68a2a72afaa91267cbfc78d8f2dd0b0fe310fa\",\"url\":\"https://api.github.com/repos/olivierGitHub/react-hello-world/git/trees/7e68a2a72afaa91267cbfc78d8f2dd0b0fe310fa\"},\"url\":\"https://api.github.com/repos/olivierGitHub/react-hello-world/git/commits/22428e8262e3324ea602602ef1d48da888a6fda2\",\"comment_count\":0,\"verification\":{\"verified\":false,\"reason\":\"unsigned\",\"signature\":null,\"payload\":null}},\"url\":\"https://api.github.com/repos/olivierGitHub/react-hello-world/commits/22428e8262e3324ea602602ef1d48da888a6fda2\",\"html_url\":\"https://github.com/olivierGitHub/react-hello-world/commit/22428e8262e3324ea602602ef1d48da888a6fda2\",\"comments_url\":\"https://api.github.com/repos/olivierGitHub/react-hello-world/commits/22428e8262e3324ea602602ef1d48da888a6fda2/comments\",\"author\":{\"login\":\"olivierGitHub\",\"id\":6985323,\"avatar_url\":\"https://avatars0.githubusercontent.com/u/6985323?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/olivierGitHub\",\"html_url\":\"https://github.com/olivierGitHub\",\"followers_url\":\"https://api.github.com/users/olivierGitHub/followers\",\"following_url\":\"https://api.github.com/users/olivierGitHub/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/olivierGitHub/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/olivierGitHub/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/olivierGitHub/subscriptions\",\"organizations_url\":\"https://api.github.com/users/olivierGitHub/orgs\",\"repos_url\":\"https://api.github.com/users/olivierGitHub/repos\",\"events_url\":\"https://api.github.com/users/olivierGitHub/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/olivierGitHub/received_events\",\"type\":\"User\",\"site_admin\":false},\"committer\":{\"login\":\"olivierGitHub\",\"id\":6985323,\"avatar_url\":\"https://avatars0.githubusercontent.com/u/6985323?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/olivierGitHub\",\"html_url\":\"https://github.com/olivierGitHub\",\"followers_url\":\"https://api.github.com/users/olivierGitHub/followers\",\"following_url\":\"https://api.github.com/users/olivierGitHub/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/olivierGitHub/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/olivierGitHub/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/olivierGitHub/subscriptions\",\"organizations_url\":\"https://api.github.com/users/olivierGitHub/orgs\",\"repos_url\":\"https://api.github.com/users/olivierGitHub/repos\",\"events_url\":\"https://api.github.com/users/olivierGitHub/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/olivierGitHub/received_events\",\"type\":\"User\",\"site_admin\":false},\"parents\":[]}]";


    @Test
    public void toJsonObjectList_should_transform_a_json_string_into_a_JosnObject_list() throws JSONException {
        // GIVEN
        String response = JSON_RESPONSE;

        // THEN
        List<JSONObject> jsonObjects = jsonHelper.toJsonObjectList(response);

        // ASSERT
        Assert.assertNotNull(jsonObjects);
        Assert.assertEquals(jsonObjects.size(), 3);
        Assert.assertEquals(jsonObjects.get(0).get("sha").toString(), "1e83bea2d19d5e937f6e9549be03c341aae627c1");
        Assert.assertEquals(jsonObjects.get(1).get("sha").toString(), "9d0c454bc2163d2d4e12419e444af3632ec141a1");
        Assert.assertEquals(jsonObjects.get(2).get("sha").toString(), "22428e8262e3324ea602602ef1d48da888a6fda2");
    }
}
